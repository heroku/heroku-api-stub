#!/usr/bin/env ruby

require "multi_json"
require "rack/instruments"
require "optparse"
require "sinatra/base"

require_relative "../lib/doc_stub"

options = {
  port: 4000
}
OptionParser.new do |opts|
  opts.banner = "Usage: heroku-api-stub [options]"
  opts.on("-p", "--port PORT", "Port to bind to") { |p| options[:port] = p }
end.parse!

path = File.expand_path("../../data/doc.json", __FILE__)
doc  = MultiJson.decode(File.read(path))
app  = DocStub::Generator.new(doc).run

app.run! port: options[:port]
